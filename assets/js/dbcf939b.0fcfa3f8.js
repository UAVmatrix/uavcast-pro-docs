"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[5831],{7249:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"configuration/camera/index","title":"Camera","description":"\'Configuration\'","source":"@site/versioned_docs/version-4.x/configuration/camera/index.md","sourceDirName":"configuration/camera","slug":"/configuration-camera","permalink":"/docs/4.x/configuration-camera","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/versioned_docs/version-4.x/configuration/camera/index.md","tags":[],"version":"4.x","frontMatter":{"slug":"/configuration-camera","title":"Camera","authors":"Bernt Christian Egeland","tags":[]},"sidebar":"tutorialSidebar","previous":{"title":"Configuration","permalink":"/docs/4.x/category/configuration"},"next":{"title":"Cellular Modem","permalink":"/docs/4.x/configuration-cell-modem"}}');var i=t(4848),r=t(8453);const o={slug:"/configuration-camera",title:"Camera",authors:"Bernt Christian Egeland",tags:[]},a=void 0,d={},l=[{value:"Camera Type",id:"camera-type",level:3},{value:"UDP / TCP / HTTP protocol",id:"udp--tcp--http-protocol",level:3},{value:"GCS Destination",id:"gcs-destination",level:3},{value:"Video resolution",id:"video-resolution",level:3},{value:"Destination Port",id:"destination-port",level:3},{value:"Bitrate",id:"bitrate",level:3},{value:"Frames Pr.second",id:"frames-prsecond",level:3},{value:"Start Video Stream",id:"start-video-stream",level:3},{value:"Receive <strong>UDP</strong> video (Windows / Mac / Linux / Android)",id:"receive-udp-video-windows--mac--linux--android",level:2},{value:"Ubuntu",id:"ubuntu",level:3},{value:"Android",id:"android",level:3},{value:"Mac OS X",id:"mac-os-x",level:3},{value:"Windows",id:"windows",level:3},{value:"#Solution #1",id:"solution-1",level:3},{value:"Solution #2",id:"solution-2",level:3},{value:"Start gstreamer For Windows/Ubuntu/Mac OS X:",id:"start-gstreamer-for-windowsubuntumac-os-x",level:3},{value:"<strong>TCP</strong> video (Windows / Mac / Linux)",id:"tcp-video-windows--mac--linux",level:2},{value:"Startup help files (Windows)",id:"startup-help-files-windows",level:2}];function c(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"&#39;Configuration&#39;",src:t(7447).A+"",width:"1920",height:"937"})}),"\n",(0,i.jsx)(n.p,{children:"UAVcast-Pro uses the well known media-handling library gstreamer to proccess the video pipeline towards the Ground Control Station.\nIt supports PiCam, Logitech C615, Logitech C920 out of the box."}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsx)(n.p,{children:"Remember to activate camera in Raspberry Config if you are using PiCam."}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"sudo raspi-config"}),"\n",(0,i.jsx)(n.img,{alt:"raspi-config",src:t(8159).A+"",width:"995",height:"307"})]})]}),"\n",(0,i.jsx)(n.h3,{id:"camera-type",children:"Camera Type"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Options: ",(0,i.jsx)(n.code,{children:"PiCam HTTP, PiCam TCP/UDP, C615, C920, Custom Pipeline"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Each camera uses different start code, also known as pipeline to be able to communicate or process the video source.\nUAVcast-Pro has three diffrent cameras pre-defined from the dropdown menu. However, if your camera is not listed then you can insert a ",(0,i.jsx)(n.strong,{children:"custom pipline"})," with the ",(0,i.jsx)(n.a,{href:"https://gstreamer.freedesktop.org/documentation/plugins.html",children:"needed plugins"})," to match your current camera model and type."]}),"\n",(0,i.jsx)(n.p,{children:"You can also send a test video by inserting the pipeline below to UAVcast-Pro custom field section, nice way to check if everything is working without the camera itself."}),"\n",(0,i.jsxs)(n.p,{children:["Remember to change the Destination address:",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.code,{children:"gst-launch-1.0 videotestsrc ! x264enc ! video/x-h264, stream-format=byte-stream ! rtph264pay ! udpsink host=GCS_ADDRESS port=5600"})]}),"\n",(0,i.jsxs)(n.p,{children:["Take a look at this page for pipeline examples\n",(0,i.jsx)(n.a,{href:"http://wiki.oz9aec.net/index.php/Gstreamer_cheat_sheet",children:"http://wiki.oz9aec.net/index.php/Gstreamer_cheat_sheet"})]}),"\n",(0,i.jsx)(n.h3,{id:"udp--tcp--http-protocol",children:"UDP / TCP / HTTP protocol"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Default value: ",(0,i.jsx)(n.code,{children:"UDP"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"UAVcast-Pro supports UDP, TCP and [HTTP live in-browser viewer for PiCam](/pages/camera/HTTP Videostream), other cameras only support UDP at the moment.\nMultiple users may view live video using the HTTP protocol."}),"\n",(0,i.jsx)(n.h3,{id:"gcs-destination",children:"GCS Destination"}),"\n",(0,i.jsxs)(n.p,{children:["All destinations you have added in ",(0,i.jsx)(n.a,{href:"configuration-ground-controller",children:"Ground Control"})," page will be shown in the dropdown list.\nIt is only possible to select one destination for video."]}),"\n",(0,i.jsx)(n.h3,{id:"video-resolution",children:"Video resolution"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Default value: ",(0,i.jsx)(n.code,{children:"240p (320x240)"})]}),"\n",(0,i.jsxs)(n.li,{children:["Options: ",(0,i.jsx)(n.code,{children:"240p (320x240), 480p (720x480), 540p (960x540), HD (1280x720), Full HD (1920x1080)"})]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"If your broadband connection has a low transfer speed, then lower the resolution to get smooth video."})}),"\n",(0,i.jsx)(n.h3,{id:"destination-port",children:"Destination Port"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Default value: ",(0,i.jsx)(n.code,{children:"5600"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Change the Video network port. ",(0,i.jsx)(n.strong,{children:"Mission Planner"})," and ",(0,i.jsx)(n.strong,{children:"QGroundControl"})," supports video in HUD by default on port 5600."]}),"\n",(0,i.jsx)(n.h3,{id:"bitrate",children:"Bitrate"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Default value: ",(0,i.jsx)(n.code,{children:"2000000"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Change the Bitrate value."}),"\n",(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsx)(n.p,{children:"If your broadband connection has a low transfer speed, then lower the Bitrate to get smooth video."}),(0,i.jsxs)(n.p,{children:["Example: ",(0,i.jsx)(n.code,{children:"800000"})]})]}),"\n",(0,i.jsx)(n.h3,{id:"frames-prsecond",children:"Frames Pr.second"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Default value: ",(0,i.jsx)(n.code,{children:"20"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Change the FPS value."}),"\n",(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsx)(n.p,{children:"If your broadband connection has a low transfer speed, then lower the FPS to get smooth video."}),(0,i.jsxs)(n.p,{children:["Example: ",(0,i.jsx)(n.code,{children:"8"})]})]}),"\n",(0,i.jsx)(n.h3,{id:"start-video-stream",children:"Start Video Stream"}),"\n",(0,i.jsx)(n.p,{children:"To verify if camera will start properly, simply press the start button.\nIf any issues, press the Log button to reveal any problems."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Start and Stop",src:t(3741).A+"",width:"815",height:"164"})}),"\n",(0,i.jsxs)(n.h2,{id:"receive-udp-video-windows--mac--linux--android",children:["Receive ",(0,i.jsx)(n.strong,{children:"UDP"})," video (Windows / Mac / Linux / Android)"]}),"\n",(0,i.jsx)(n.h3,{id:"ubuntu",children:"Ubuntu"}),"\n",(0,i.jsx)(n.p,{children:"If you're going to stream to a Ubuntu PC, install the some packages locally beforehand."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt-get update\nsudo apt-get install gstreamer1.0-tools gstreamer1.0-plugins-good gstreamer1.0-plugins-bad\n"})}),"\n",(0,i.jsx)(n.h3,{id:"android",children:"Android"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Download and install ",(0,i.jsx)(n.a,{href:"https://play.google.com/store/apps/details?id=org.mavlink.qgroundcontrol",children:"QGroundControl"})," for Android."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Find IP address of your device in preferences. You'll need it in order to connect to the phone from your RPi."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Run QGroundControl and it will automatically detect your vehicle."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Note: default port for video in QGC application is 5600"})}),"\n",(0,i.jsxs)(n.p,{children:["Here's the app in action\n",(0,i.jsx)(n.img,{alt:"capture",src:t(638).A+"",width:"643",height:"362"})]}),"\n",(0,i.jsx)(n.h3,{id:"mac-os-x",children:"Mac OS X"}),"\n",(0,i.jsx)(n.p,{children:"The simplest way is to use brew. To install it run the following in your Mac terminal:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"\nbrew update\nbrew install gstreamer gst-libav gst-plugins-ugly gst-plugins-base gst-plugins-bad gst-plugins-good\n'})}),"\n",(0,i.jsx)(n.h3,{id:"windows",children:"Windows"}),"\n",(0,i.jsx)(n.h3,{id:"solution-1",children:"#Solution #1"}),"\n",(0,i.jsxs)(n.p,{children:["Download and install ",(0,i.jsx)(n.a,{href:"http://ardupilot.org/planner/docs/mission-planner-installation.html",children:"Mission Planner"})," or ",(0,i.jsx)(n.a,{href:"http://qgroundcontrol.com/downloads/",children:"QGroundControl"}),"\nboth applications supports ",(0,i.jsx)(n.strong,{children:"UDP"})," video by default on port 5600 without any extra configuration. Start camera in UAVcast-Pro and open MP or QGC"]}),"\n",(0,i.jsxs)(n.admonition,{title:"Streaming over VPN may cause poor video quality in MP and QGC",type:"warning",children:[(0,i.jsxs)(n.p,{children:["If you experience issues when streaming by VPN, such as ",(0,i.jsx)(n.strong,{children:"pixalating frames"})," or ",(0,i.jsx)(n.strong,{children:"grey overlay"})," then change the gstreamer source in Mission Planner HUD, with this pipeline:"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'udpsrc port=5601 caps = "application/x-rtp, media=video, clock-rate=90000, encoding-name=H264, payload=96" ! rtpjitterbuffer ! rtph264depay ! avdec_h264 ! videoconvert ! video/x-raw,format=BGRA ! appsink name=outsink\n'})}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"NOTE!"})}),(0,i.jsxs)(n.p,{children:["Mission Planner always starts its default gstreamer pipeline and listen on default port 5600, when using the custom source above we need to use a diffrent port so it wont make any conflicts. In this example we use ",(0,i.jsx)(n.strong,{children:"port 5601"}),". Remember set port ",(0,i.jsx)(n.a,{href:"http://docs.uavmatrix.com/pages/Camera/#destination-port",children:"5601"})," in UAVcast-Pro as well!\n",(0,i.jsx)(n.img,{alt:"hud-source",src:t(35).A+"",width:"806",height:"316"})]})]}),"\n",(0,i.jsx)(n.h3,{id:"solution-2",children:"Solution #2"}),"\n",(0,i.jsxs)(n.p,{children:["Download and install ",(0,i.jsx)(n.a,{href:"https://gstreamer.freedesktop.org/data/pkg/windows/1.4.5/gstreamer-1.0-x86_64-1.4.5.msi",children:"gstreamer for Windows"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Open a new command-prompt window and navigate to the gstreamer bin folder, usually ",(0,i.jsx)(n.code,{children:"C:\\gstreamer\\1.0\\x86_64\\bin"})]}),"\n",(0,i.jsx)(n.h3,{id:"start-gstreamer-for-windowsubuntumac-os-x",children:"Start gstreamer For Windows/Ubuntu/Mac OS X:"}),"\n",(0,i.jsx)(n.p,{children:"Paste this gstreamer command in the command-prompt(windows) or terminal (unix/mac) to start gstreamer."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'gst-launch-1.0 -v udpsrc port=5600 caps="application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)H264" ! rtpjitterbuffer ! rtph264depay ! avdec_h264 ! videoconvert ! autovideosink sync=false\n'})}),"\n",(0,i.jsx)(n.p,{children:"From now on, your computer will be waiting for the input stream from Raspberry PI. Once it gets a stream, you'll see the real-time video from your drone."}),"\n",(0,i.jsxs)(n.h2,{id:"tcp-video-windows--mac--linux",children:[(0,i.jsx)(n.strong,{children:"TCP"})," video (Windows / Mac / Linux)"]}),"\n",(0,i.jsxs)(n.p,{children:["Select TCP from the dropdown menu in UAVcast-Pro web interface. Add your raspberry IP address (if you use Zerotier VPN, add ZT IP address) in the ",(0,i.jsx)(n.strong,{children:"TCP Host"})," input box."]}),"\n",(0,i.jsxs)(n.p,{children:["Press Start camera button.\nYou should see ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"video started successfully"})})]}),"\n",(0,i.jsx)(n.p,{children:"Install gstreamer for your operating system (see above section), then open a new command-prompt(windows) or terminal(unix/mac)"}),"\n",(0,i.jsx)(n.p,{children:"Paste this gstreamer command in the command-prompt(windows) or terminal (unix/mac) to start gstreamer."}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"Windows users needs to navigate to gstreamer folder before using the below gstreamer command."})}),"\n",(0,i.jsxs)(n.p,{children:["You need to change the ",(0,i.jsx)(n.strong,{children:"PI_IP"})," to the same as you used for ",(0,i.jsx)(n.strong,{children:"TCP Host"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"gst-launch-1.0 -v tcpclientsrc host=PI_IP port=5600 ! gdpdepay ! rtph264depay ! avdec_h264 ! videoconvert ! autovideosink sync=false\n"})}),"\n",(0,i.jsx)(n.p,{children:"From now on, your computer will be connecting towards Raspberry PI. Once it gets a stream, you'll see the real-time video from your drone."}),"\n",(0,i.jsx)(n.h2,{id:"startup-help-files-windows",children:"Startup help files (Windows)"}),"\n",(0,i.jsx)(n.p,{children:"It's possible to save the gstreamer pipline to a .cmd file, then you can just double click the file and video will start automatically."}),"\n",(0,i.jsxs)(n.p,{children:["Download files below, then right click and select ",(0,i.jsx)(n.em,{children:"edit"}),". Change the port number or path of gstreamer if necessary."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://drive.google.com/uc?authuser=0&id=1SjDT5Tm-N0wExwBla9sG1aPeW5MS1P4b&export=download",children:"gstreamer UDP start file"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://drive.google.com/uc?authuser=0&id=1JzHNvtGJNaPBxBIfDmD0OI1O_DT08CQ7&export=download",children:"gstreamer TCP start file"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},7447:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/config-3ac116228cfd590b8d8934a40cd8690e.jpg"},35:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/hud-gstreamer-9d8806c09cc98d5c4ca5d1f2c7af977e.jpg"},638:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/qgc-b09c200dc64fe681ef81f99f846a48d1.jpg"},8159:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/raspi-config-5a3e5d46c3cfe9303adcb559e6fbc8dd.png"},3741:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/startstop-57ae67e77bfdb54d0c28004d72a0836c.jpg"},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var s=t(6540);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);